# 2025년 11월 1일 개발 로그

## 프로젝트: VC-Arkanoid

### 작업 요약

- main.py의 24개 개선점을 발견하고 우선순위(P0-P5)로 분류
- P0(치명적), P1(핵심 기능), P2(게임 경험) 총 10개 항목 수정 완료
- 게임의 핵심 기능 결함 해결 및 사용자 경험 대폭 개선

---

## 개선점 분석 프로세스

### 1. 코드 리뷰 및 기획 문서 대조
- `Context.md` 및 `20251031_01_개발로그.md` 검토
- 기획 의도와 실제 구현 간의 차이점 식별
- 24개 개선점 발견 및 5단계 우선순위로 분류

### 2. 우선순위 분류 기준
- **P0**: 게임 크래시를 유발하는 치명적 버그
- **P1**: 기획서에 명시된 핵심 기능의 미구현 또는 오작동
- **P2**: 사용자 경험에 직접적 영향을 주는 문제
- **P3**: 밸런싱 및 확장성 문제
- **P4**: 코드 품질 및 유지보수성
- **P5**: 물리 엔진 최적화

---

## 완료된 작업 상세

### P0: 치명적 버그 수정

#### 1. Disrupt 파워업 크래시 버그 수정
- **위치**: `main.py:424`
- **문제**: `new__ball2` 변수명 오타 (밑줄 2개)
- **영향**: Disrupt 파워업 획득 시 `NameError`로 게임 크래시
- **해결**: `new_ball2`로 수정
- **파일**: main.py:424

---

### P1: 핵심 기능 구현

#### 2. 점수 시스템 완전 구현
- **문제**: 공으로 벽돌/적 파괴 시 점수가 증가하지 않음
- **원인**: `Ball.move()` 메서드에서 Game 객체 접근 불가
- **해결 방법**:
  - `Ball.move()` 메서드에 `game` 매개변수 추가
  - 벽돌 파괴: +10점
  - 적 제거: +50점
  - 보스(DOH) 타격: +100점
- **수정 파일**: main.py:55, 85, 97, 105, 296

#### 3. 레이저 양쪽 발사 구현
- **문제**: 기획서에 "패들 양쪽에서 레이저 발사"라고 명시되어 있으나 중앙에서만 발사됨
- **해결**:
  - 마우스 클릭 시 패들의 좌측(`left + 10`)과 우측(`right - 10`)에서 동시에 2개의 레이저 발사
  - 원작 Arkanoid의 레이저 시스템과 동일하게 구현
- **수정 파일**: main.py:286-289

#### 4. 패들 반사 각도 조절 시스템
- **문제**: 공이 패들에 맞을 때 항상 `dy *= -1`만 수행하여 각도 조절 불가
- **기획 요구사항**: "패들의 어느 부분에 맞느냐에 따라 공의 반사 각도가 달라질 수 있음"
- **해결 방법**:
  - 패들에 맞은 위치를 0.0(좌측 끝) ~ 1.0(우측 끝)으로 정규화
  - `dx = (hit_pos - 0.5) * 16`으로 수평 속도 조절
  - 좌측에 맞으면 왼쪽으로, 우측에 맞으면 오른쪽으로 반사
  - 중앙에 맞으면 거의 수직으로 반사
- **효과**: 플레이어가 공의 방향을 의도적으로 조절 가능
- **수정 파일**: main.py:70-83

---

### P2: 게임 경험 개선

#### 5. 키보드 조작 구현
- **문제**: 기획서에 "보조 조작: 키보드 좌/우 화살표"라고 명시되어 있으나 마우스만 지원
- **해결**:
  - `Paddle` 클래스에 `speed = 8` 속성 추가
  - 좌/우 화살표 키로 패들 이동
  - 마우스(주 조작)와 키보드(보조 조작)를 동시에 지원
- **수정 파일**: main.py:34, 40-45

#### 6. 파워업 시각적 구분 시스템
- **문제**: 모든 파워업이 파란색 사각형으로 표시되어 종류 구분 불가
- **해결**:
  - 7가지 파워업별로 고유 색상 할당:
    - E (Enlarge): 초록색
    - S (Slow): 빨간색
    - L (Laser): 노란색
    - C (Catch): 청록색
    - D (Disrupt): 자홍색
    - B (Break): 주황색
    - P (Player): 분홍색
  - 각 파워업 중앙에 문자 라벨 표시
- **효과**: 플레이어가 어떤 파워업인지 즉시 식별 가능
- **수정 파일**: main.py:159-195

#### 7. 일시정지 기능
- **문제**: 게임 중 멈출 수 없어 사용성 저하
- **해결**:
  - P 키 또는 ESC 키로 일시정지 토글
  - 일시정지 중 게임 업데이트 중단
  - 반투명 검은색 오버레이 + "PAUSED" 텍스트 표시
  - "Press P or ESC to resume" 안내 메시지
- **수정 파일**: main.py:271, 329-331, 344-345, 550-557

#### 8. 재시작 기능
- **문제**: 게임 오버/클리어 후 프로그램을 다시 실행해야 함
- **해결**:
  - 게임 오버/클리어 화면에서 선택 가능:
    - R 키: 게임 재시작 (레벨 1부터, 점수 초기화)
    - ESC 키: 게임 종료
  - `reset_game()` 메서드로 모든 게임 상태 초기화
  - 최종 점수 표시 추가
- **수정 파일**: main.py:310-345, 525-555

---

## 기술적 세부사항

### 점수 시스템 리팩토링
- **Before**: `Ball.move(paddle, bricks, power_ups, enemies, sound_manager, doh)`
- **After**: `Ball.move(paddle, bricks, power_ups, enemies, sound_manager, doh, game)`
- Game 객체를 전달하여 점수 직접 조작 가능

### 패들 반사 각도 계산식
```python
hit_pos = (ball.centerx - paddle.left) / paddle.width  # 0.0 ~ 1.0
dx = (hit_pos - 0.5) * 16  # -8 ~ +8
dy = -abs(dy)  # 항상 위로 반사
```

### 파워업 색상 매핑
- `color_map` 딕셔너리로 타입별 색상 관리
- `label_map` 딕셔너리로 표시 문자 관리
- 확장성을 고려한 구조

---

## 테스트 권장 사항

### 필수 테스트 항목
1. **Disrupt 파워업**: 멀티볼 생성 시 크래시 없는지 확인
2. **점수 시스템**: 벽돌/적/보스 타격 시 점수 정상 증가 확인
3. **레이저**: 양쪽에서 동시 발사되는지 확인
4. **패들 반사**: 패들의 다른 위치에 공을 맞춰 각도 변화 확인
5. **키보드 조작**: 좌/우 화살표 키로 패들 이동 가능 확인
6. **파워업 구분**: 7가지 파워업이 서로 다른 색상으로 표시되는지 확인
7. **일시정지**: P/ESC 키로 정지/재개 확인
8. **재시작**: 게임 오버 후 R 키로 재시작 확인

---

## 남은 개선 과제 (향후 작업)

### P3: 밸런싱 및 확장성 (5개)
- 보스 등장 시점 조정 (현재 2번째 → 33번째 스테이지)
- 스테이지 수 확장 (현재 2개 → 5~10개)
- 파워업 드롭률 설정값 분리
- Catch 파워업 해제 조건 개선
- 파워업 중복 적용 처리

### P4: 코드 품질 (5개)
- 매직 넘버 상수화
- 사운드 경로 설정 파일로 분리
- 예외 처리 추가
- 타입 힌팅 적용
- 벽돌 타격 횟수 시각화

### P5: 물리 엔진 개선 (4개)
- 공 속도 정규화 (피타고라스 정리 적용)
- 공 갇힘 방지 로직
- 모서리 충돌 처리
- 다중 공 관리 개선

---

## 성과 요약

- **버그 수정**: 1개 (게임 크래시 버그)
- **핵심 기능 구현**: 4개 (점수 시스템, 레이저, 반사 각도, 보스 점수)
- **UX 개선**: 5개 (키보드, 파워업 구분, 일시정지, 재시작)
- **코드 수정 범위**: main.py 약 40개 라인 수정/추가
- **테스트 상태**: 수동 테스트 필요

---

## 다음 단계

1. **즉시 권장**: 수정된 코드 테스트 및 검증
2. **Phase 5 진행**: 밸런싱 및 스테이지 확장 (P3 작업)
3. **코드 품질**: 리팩토링 및 최적화 (P4, P5 작업)
4. **배포 준비**: 최종 테스트 및 빌드

---

**작업자 노트**: Context.md의 기획 의도를 충실히 반영하여 핵심 기능을 완성했습니다. 게임의 완성도가 크게 향상되었으며, 이제 사용자 테스트 및 밸런싱 단계로 진행할 수 있습니다.
